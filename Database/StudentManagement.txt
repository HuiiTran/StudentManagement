CREATE TABLE KHOA (
    MaKhoa TEXT PRIMARY KEY NOT NULL,
    TenKhoa TEXT
);

CREATE TABLE NGANH (
    MaNganh TEXT PRIMARY KEY NOT NULL,
    TenNganh TEXT,
    MaKhoa TEXT NOT NULL,
    FOREIGN KEY (MaKhoa) REFERENCES KHOA(MaKhoa)
);

CREATE TABLE GIAOVIEN (
    MaGV TEXT PRIMARY KEY NOT NULL,
    TenGV TEXT,
    MaKhoa TEXT NOT NULL,
    FOREIGN KEY (MaKhoa) REFERENCES KHOA(MaKhoa)
);

CREATE TABLE MONHOC (
    MaMH TEXT PRIMARY KEY NOT NULL,
    TenMH TEXT,
    SoTinChi INTEGER
);

CREATE TABLE LOPHOC (
    MaLop TEXT PRIMARY KEY NOT NULL,
    TenLop TEXT,
    MaGV TEXT NOT NULL,
    MaMH TEXT NOT NULL,
    FOREIGN KEY (MaGV) REFERENCES GIAOVIEN(MaGV),
    FOREIGN KEY (MaMH) REFERENCES MONHOC(MaMH)
);

CREATE TABLE SINHVIEN (
    MaSV TEXT PRIMARY KEY NOT NULL,
    TenSV TEXT,
    NgaySinh TEXT,
    GioiTinh TEXT,
    MaNganh TEXT NOT NULL,
    FOREIGN KEY (MaNganh) REFERENCES NGANH(MaNganh)
);

CREATE TABLE DANGKY (
    MaSV TEXT NOT NULL,
    MaMH TEXT NOT NULL,
    KyHoc INTEGER,
    PRIMARY KEY (MaSV, MaMH),
    FOREIGN KEY (MaSV) REFERENCES SINHVIEN(MaSV),
    FOREIGN KEY (MaMH) REFERENCES MONHOC(MaMH)
);

CREATE TABLE LOAIDIEM(
    MaLoaiDiem TEXT PRIMARY KEY NOT NULL,
    TenLoaiDiem TEXT
);

CREATE TABLE TILEDIEM (
    MaMH TEXT NOT NULL,
    MaLoaiDiem TEXT NOT NULL,
    TiLe REAL,
    PRIMARY KEY (MaMH, MaLoaiDiem),
    FOREIGN KEY (MaMH) REFERENCES MONHOC(MaMH),
    FOREIGN KEY (MaLoaiDiem) REFERENCES LOAIDIEM(MaLoaiDiem)
);

CREATE TABLE DIEM (
    MaSV TEXT NOT NULL,
    MaMH TEXT NOT NULL,
    MaLoaiDiem TEXT NOT NULL,
    Diem INTEGER,
    PRIMARY KEY (MaSV, MaMH, MaLoaiDiem),
    FOREIGN KEY (MaSV) REFERENCES SINHVIEN(MaSV),
    FOREIGN KEY (MaMH) REFERENCES MONHOC(MaMH),
    FOREIGN KEY (MaLoaiDiem) REFERENCES LOAIDIEM(MaLoaiDiem)
);